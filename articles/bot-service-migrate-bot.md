---
title: Migración de un bot a Azure | Microsoft Docs
description: Obtenga información sobre cómo migrar su bot desde el Portal de Bot Framework heredado a un servicio de bot en Azure portal.
author: v-ducvo
ms.author: v-ducvo
manager: kamrani
ms.topic: article
ms.prod: bot-framework
ms.date: 6/22/2017
monikerRange: azure-bot-service-3.0
ms.openlocfilehash: e8c927ce49a2d8aecf0113a09cbedcf1135a8380
ms.sourcegitcommit: f576981342fb3361216675815714e24281e20ddf
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 07/18/2018
ms.locfileid: "39305552"
---
# <a name="migrate-your-bot-to-azure"></a><span data-ttu-id="eb177-103">Migración de un bot a Azure</span><span class="sxs-lookup"><span data-stu-id="eb177-103">Migrate your bot to Azure</span></span>

<span data-ttu-id="eb177-104">Todos los bots de **Azure Bot Service (versión preliminar)** creados en el [Portal de Bot Framework](http://dev.botframework.com) se deben migrar al nuevo Bot Service en Azure.</span><span class="sxs-lookup"><span data-stu-id="eb177-104">All **Azure Bot Service (Preview)** bots created in the [Bot Framework Portal](http://dev.botframework.com) must migrate to the new Bot Service in Azure.</span></span> <span data-ttu-id="eb177-105">El servicio se ofreció con disponibilidad general (GA) en diciembre de 2017.</span><span class="sxs-lookup"><span data-stu-id="eb177-105">The service was made generally available (GA) in December 2017.</span></span> 

<span data-ttu-id="eb177-106">Tenga en cuenta que *no* es necesario migrar los bots de registro conectados solo a los siguientes canales: **Teams**, **Skype** o **Cortana**.</span><span class="sxs-lookup"><span data-stu-id="eb177-106">Note that, registration bots connected only to the following channels are *not* required to migrate: **Teams**, **Skype**, or **Cortana**.</span></span> <span data-ttu-id="eb177-107">Por ejemplo, un bot de registro conectado a **Facebook** y **Skype** *se debe* migrar, pero con un bot de registro conectado a **Skype**y **Cortana** *no es necesario* realizar la migración.</span><span class="sxs-lookup"><span data-stu-id="eb177-107">For example, a registration bot connected to **Facebook** and **Skype** *is required* to migrate but a registration bot connected to **Skype** and **Cortana** *is not required* to migrate.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="eb177-108">Antes de migrar un bot de Functions creado con Node.js, es necesario utilizar **Azure Functions Pack** para empaquetar juntos los módulos **node_modules**.</span><span class="sxs-lookup"><span data-stu-id="eb177-108">Before migrating a Functions bot created with Node.js, it is required that you use **Azure Functions Pack** to package the **node_modules** modules together.</span></span> <span data-ttu-id="eb177-109">Si lo hace, mejorará el rendimiento durante la migración y la ejecución del bot de Functions después de su migración.</span><span class="sxs-lookup"><span data-stu-id="eb177-109">Doing so will improve performance during migration and execution of the Functions bot after it is migrated.</span></span> <span data-ttu-id="eb177-110">Para empaquetar los módulos, consulte [Empaquetado de un bot de Functions con Funcpack](#package-a-functions-bot-with-funcpack).</span><span class="sxs-lookup"><span data-stu-id="eb177-110">To package your modules, see [Package a Functions bot with Funcpack](#package-a-functions-bot-with-funcpack).</span></span>

<span data-ttu-id="eb177-111">Para migrar el bot, realice lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="eb177-111">To migrate your bot, do the following:</span></span>

1. <span data-ttu-id="eb177-112">Inicie sesión en el [Portal de Bot Framework](http://dev.botframework.com) y haga clic en **Mis bots**.</span><span class="sxs-lookup"><span data-stu-id="eb177-112">Sign into the [Bot Framework Portal](http://dev.botframework.com) and click **My bots**.</span></span>
2. <span data-ttu-id="eb177-113">Haga clic en el botón **Migrar** del bot que desea migrar.</span><span class="sxs-lookup"><span data-stu-id="eb177-113">Click **Migrate** button for the bot you want to migrate.</span></span>
3. <span data-ttu-id="eb177-114">Acepte los **Términos** y haga clic en **Migrar** para iniciar el proceso de migración o haga clic en **Cancelar** para cancelar esta acción.</span><span class="sxs-lookup"><span data-stu-id="eb177-114">Accept the **Terms** and click **Migrate** to start the migration process or click **Cancel** to cancel this action.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="eb177-115">Mientras la tarea de migración está en curso, no salga de la página ni actualice la página.</span><span class="sxs-lookup"><span data-stu-id="eb177-115">While the migration task is in progress, do not navigate away from the page or refresh the page.</span></span> <span data-ttu-id="eb177-116">Si lo hace, hará que la tarea de migración se detenga de forma prematura y tendrá que realizar la acción de nuevo.</span><span class="sxs-lookup"><span data-stu-id="eb177-116">Doing so will cause the migration task to stop pre-maturely and you will have to perform the action again.</span></span> <span data-ttu-id="eb177-117">Para asegurarse de que la migración se realiza correctamente, espere el mensaje de confirmación.</span><span class="sxs-lookup"><span data-stu-id="eb177-117">To ensure the migration completes successfully, wait for the confirmation message.</span></span>

<span data-ttu-id="eb177-118">Después de que el proceso de migración finaliza correctamente, el **Estado de migración** indicará que el bot se ha migrado y estará disponible un botón **Revertir la migración** durante una semana después de la fecha de migración en caso de problemas.</span><span class="sxs-lookup"><span data-stu-id="eb177-118">After the migration process completes successfully, the **Migration status** will indicate that the bot is migrated and a **Roll back migration** button will be available for a week after the migration date in case of issues.</span></span>

<span data-ttu-id="eb177-119">Al hacer clic en el nombre de un bot migrado, se abrirá el bot en [Azure Portal](http://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="eb177-119">Clicking the name of a migrated bot will open the bot in the [Azure portal](http://portal.azure.com).</span></span>

## <a name="package-a-functions-bot-with-funcpack"></a><span data-ttu-id="eb177-120">Empaquetado de un bot de Functions con Funcpack</span><span class="sxs-lookup"><span data-stu-id="eb177-120">Package a Functions bot with Funcpack</span></span>

<span data-ttu-id="eb177-121">Los bots de Functions creados con Node.js deben empaquetarse con [Funcpack](https://github.com/Azure/azure-functions-pack) antes de su migración.</span><span class="sxs-lookup"><span data-stu-id="eb177-121">Functions bots created with Node.js must be packed using [Funcpack](https://github.com/Azure/azure-functions-pack) before migrating.</span></span> <span data-ttu-id="eb177-122">Para empaquetar el proyecto con Funcpack, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="eb177-122">To Funcpack your project, follow these steps:</span></span>

1.  <span data-ttu-id="eb177-123">[Descargue](bot-service-build-download-source-code.md#download-bot-source-code) el código localmente si no lo ha hecho ya.</span><span class="sxs-lookup"><span data-stu-id="eb177-123">[Download](bot-service-build-download-source-code.md#download-bot-source-code) your code locally if you haven’t already.</span></span>
2.  <span data-ttu-id="eb177-124">Actualice todos los paquetes de npm de **packages.json** a las versiones más recientes y ejecute `npm install`.</span><span class="sxs-lookup"><span data-stu-id="eb177-124">Update all the npm packages in **packages.json** to the latest versions and then run `npm install`.</span></span>
3.  <span data-ttu-id="eb177-125">Abra **messages/index.js** y cambie `module.exports = { default: connector.listen() }` por `module.exports = connector.listen();`</span><span class="sxs-lookup"><span data-stu-id="eb177-125">Open **messages/index.js** and change `module.exports = { default: connector.listen() }` to `module.exports = connector.listen();`</span></span>
4.  <span data-ttu-id="eb177-126">Instale Funcpack con npm: `npm install -g azure-functions-pack`</span><span class="sxs-lookup"><span data-stu-id="eb177-126">Install Funcpack via npm: `npm install -g azure-functions-pack`</span></span>
5.  <span data-ttu-id="eb177-127">Para empaquetar el directorio **node_modules**, ejecute el siguiente comando: `funcpack pack ./`</span><span class="sxs-lookup"><span data-stu-id="eb177-127">To package the **node_modules** directory, run the following command: `funcpack pack ./`</span></span>
6.  <span data-ttu-id="eb177-128">Pruebe el bot localmente mediante la ejecución del bot de Functions con el emulador de Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="eb177-128">Test your bot locally by running the Functions bot using the Bot Framework Emulator.</span></span> <span data-ttu-id="eb177-129">Más información sobre cómo ejecutar el bot de *funcpack* [aquí](https://github.com/Azure/azure-functions-pack#how-to-run).</span><span class="sxs-lookup"><span data-stu-id="eb177-129">More info on how to run the *funcpack* bot [here](https://github.com/Azure/azure-functions-pack#how-to-run).</span></span> 
7.  <span data-ttu-id="eb177-130">Cargue el código a Azure.</span><span class="sxs-lookup"><span data-stu-id="eb177-130">Upload your code back to Azure.</span></span> <span data-ttu-id="eb177-131">Asegúrese de que se carga el directorio `.funcpack`.</span><span class="sxs-lookup"><span data-stu-id="eb177-131">Make sure the `.funcpack` directory is uploaded.</span></span> <span data-ttu-id="eb177-132">No es necesario cargar el directorio **node_modules**.</span><span class="sxs-lookup"><span data-stu-id="eb177-132">You do not need to upload the **node_modules** directory.</span></span>
8. <span data-ttu-id="eb177-133">Pruebe el bot en remoto para asegurarse de que responde según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="eb177-133">Test your remote bot to make sure it responds as expected.</span></span>
9. <span data-ttu-id="eb177-134">[Realice la migración del bot](#migrate-your-bot-to-azure) siguiendo los pasos anteriores.</span><span class="sxs-lookup"><span data-stu-id="eb177-134">[Migrate your bot](#migrate-your-bot-to-azure) using the steps above.</span></span>

## <a name="migration-under-the-hood"></a><span data-ttu-id="eb177-135">Funcionamiento interno de la migración</span><span class="sxs-lookup"><span data-stu-id="eb177-135">Migration under the hood</span></span>

<span data-ttu-id="eb177-136">En función del tipo de bot que vaya a migrar, la lista siguiente puede ayudarle a entender mejor lo que sucede en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="eb177-136">Depending on the type of bot you are migrating, the list below can help you better understand what is happening under the hood.</span></span>

* <span data-ttu-id="eb177-137">**Bot de aplicación web** o **Bot de Functions**: para estos tipos de bots, el código fuente del proyecto se copia desde el bot antiguo al nuevo bot.</span><span class="sxs-lookup"><span data-stu-id="eb177-137">**Web App Bot** or **Functions Bot**: For these types of bots, the source code project is copied from the old bot to the new bot.</span></span> <span data-ttu-id="eb177-138">Otros recursos, como el almacenamiento del bot, Application Insights, LUIS, etc. se dejan como están.</span><span class="sxs-lookup"><span data-stu-id="eb177-138">Other resources such as your bot's storage, Application Insights, LUIS, etc. are left as is.</span></span> <span data-ttu-id="eb177-139">En esos casos, el bot nuevo contiene una copia de los identificadores, las claves y las contraseñas de esos recursos existentes.</span><span class="sxs-lookup"><span data-stu-id="eb177-139">In those cases, the new bot contains a copy of the IDs/keys/passwords to those existing resources.</span></span> 
* <span data-ttu-id="eb177-140">**Bot de registro de canales**: para este tipo de bots, el proceso de migración simplemente crear un nuevo **Bot de registro de canales** y copia el punto de conexión del bot antiguo.</span><span class="sxs-lookup"><span data-stu-id="eb177-140">**Bot Channels Registration**: For this type of bots, the migration process simply create a new **Bot Channels Registration** and copy the endpoint from the old bot over.</span></span> 
* <span data-ttu-id="eb177-141">Independientemente de los tipos de los bots que se van a migrar, el proceso de migración no modifica el estado del bot existente de ningún modo.</span><span class="sxs-lookup"><span data-stu-id="eb177-141">Regardless of the types of bots you are migrating, the migration process does not modify the existing bot's state in anyway.</span></span> <span data-ttu-id="eb177-142">Esto le permitirá revertir de forma segura si necesita hacerlo.</span><span class="sxs-lookup"><span data-stu-id="eb177-142">This allows you to safely roll back if you need to do so.</span></span>
* <span data-ttu-id="eb177-143">Si tiene configurada la [implementación continua](bot-service-build-continuous-deployment.md), deberá configurarla de nuevo para que el control de código fuente se conecte con el nuevo bot.</span><span class="sxs-lookup"><span data-stu-id="eb177-143">If you have [continuous deployment](bot-service-build-continuous-deployment.md) set up, you will need to set it up again so that your source control connects to the new bot instead.</span></span>

## <a name="understanding-azure-resources-after-migration"></a><span data-ttu-id="eb177-144">Descripción de los recursos de Azure después de la migración</span><span class="sxs-lookup"><span data-stu-id="eb177-144">Understanding Azure Resources after migration</span></span>
<span data-ttu-id="eb177-145">Una vez que se realiza la migración, el **grupo de recursos** contendrá una serie de recursos de Azure que son necesarios para que el bot funcione.</span><span class="sxs-lookup"><span data-stu-id="eb177-145">Once migration is done, your **Resource Group** will contain a number of Azure resources that are needed for your bot to work.</span></span> <span data-ttu-id="eb177-146">El tipo y número de recursos dependen del tipo de bot que haya migrado.</span><span class="sxs-lookup"><span data-stu-id="eb177-146">The type and number of resources depend on the type of bot have you migrated.</span></span> <span data-ttu-id="eb177-147">Consulte las secciones siguientes para más información.</span><span class="sxs-lookup"><span data-stu-id="eb177-147">Refer to following sections to lean more.</span></span>

### <a name="registration-bot"></a><span data-ttu-id="eb177-148">Bot de registro</span><span class="sxs-lookup"><span data-stu-id="eb177-148">Registration Bot</span></span>

<span data-ttu-id="eb177-149">Este es el tipo más sencillo.</span><span class="sxs-lookup"><span data-stu-id="eb177-149">This is the simplest type.</span></span> <span data-ttu-id="eb177-150">El grupo de recursos de Azure solo contendrá un recurso del tipo "Bot de registro de canales".</span><span class="sxs-lookup"><span data-stu-id="eb177-150">The Resource Group in Azure will only contain one resource of type “Bot Channel Registration”.</span></span> <span data-ttu-id="eb177-151">Esto es el equivalente al anterior registro del bot en el Portal para desarrolladores de Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="eb177-151">This is the equivalent of the previous bot record in the Bot Framework Developer Portal.</span></span>

![Listas de bots de registro de canales en Azure](~/media/bot-service-migrate-bot/channel-registration-bot.png)

### <a name="web-app-bot"></a><span data-ttu-id="eb177-153">Bot de aplicación web</span><span class="sxs-lookup"><span data-stu-id="eb177-153">Web App Bot</span></span>
<span data-ttu-id="eb177-154">La migración de un bot de aplicación web aprovisionará un recurso de Bot Service del tipo "Bot de aplicación Web" y una nueva aplicación web de App Service (en verde en la siguiente captura de pantalla).</span><span class="sxs-lookup"><span data-stu-id="eb177-154">The Web App bot migration will provision a Bot Service resource of type “Web App Bot” and a new App Service Web App (in green in the screenshot below).</span></span> <span data-ttu-id="eb177-155">El bot de Azure Bot Service (versión preliminar) anterior seguirá existiendo y se puede eliminar (en rojo en la siguiente captura de pantalla).</span><span class="sxs-lookup"><span data-stu-id="eb177-155">The previous Azure Bot Service (Preview) bot will still be there and can be deleted (in red in the screenshot below).</span></span>

![Listas de bots de aplicación web en Azure](~/media/bot-service-migrate-bot/web-app-bot.png)

### <a name="functions-bot"></a><span data-ttu-id="eb177-157">Bot de Functions</span><span class="sxs-lookup"><span data-stu-id="eb177-157">Functions Bot</span></span>
<span data-ttu-id="eb177-158">La migración de un bot de Functions aprovisionará un recurso de Bot Service del tipo "Bot de Functions" y una nueva aplicación de función de App Service (en verde en la siguiente captura de pantalla).</span><span class="sxs-lookup"><span data-stu-id="eb177-158">The Functions bot migration will provision a Bot Service resource of type “Functions Bot” and a new App Service Functions App (in green in the screenshot below).</span></span> <span data-ttu-id="eb177-159">El bot de Azure Bot Service (versión preliminar) anterior seguirá existiendo y se puede eliminar (en rojo en la siguiente captura de pantalla).</span><span class="sxs-lookup"><span data-stu-id="eb177-159">The previous Azure Bot Service (Preview) bot will still be there and can be deleted (in red in the screenshot below).</span></span>

![Listas de bots de Functions en Azure](~/media/bot-service-migrate-bot/functions-bot.png)


## <a name="roll-back-migration"></a><span data-ttu-id="eb177-161">Reversión de la migración</span><span class="sxs-lookup"><span data-stu-id="eb177-161">Roll back migration</span></span>

<span data-ttu-id="eb177-162">En caso de que algo haya ido mal con el bot durante la migración o después de la misma, puede **revertir la migración**.</span><span class="sxs-lookup"><span data-stu-id="eb177-162">In the event something went wrong with the bot during migration or after it is migrated, you can **Roll back migration**.</span></span> <span data-ttu-id="eb177-163">Para revertir una migración, realice lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="eb177-163">To roll back a migration, do the following:</span></span>

1. <span data-ttu-id="eb177-164">Inicie sesión en el [Portal de Bot Framework](http://dev.botframework.com) y haga clic en **Mis bots**.</span><span class="sxs-lookup"><span data-stu-id="eb177-164">Sign into the [Bot Framework Portal](http://dev.botframework.com) and click **My bots**.</span></span>
2. <span data-ttu-id="eb177-165">Haga clic en el botón **Revertir migración** del bot que desea revertir.</span><span class="sxs-lookup"><span data-stu-id="eb177-165">Click **Roll back migration** button for the bot you want to roll back.</span></span> <span data-ttu-id="eb177-166">Aparecerá un aviso.</span><span class="sxs-lookup"><span data-stu-id="eb177-166">A prompt will appear.</span></span>
3. <span data-ttu-id="eb177-167">Haga clic en **Sí, revertir** para continuar o en **Cancelar** para cancelar la acción de reversión.</span><span class="sxs-lookup"><span data-stu-id="eb177-167">Click **Yes, roll back** to proceed or **Cancel** to cancel the roll back action.</span></span>

> [!NOTE]
> <span data-ttu-id="eb177-168">La funcionalidad de reversión estará disponible durante una semana después de la migración y debe usarse solo si surgen problemas en el bot migrado.</span><span class="sxs-lookup"><span data-stu-id="eb177-168">Roll back functionality will be available for a week after migration, and should be used only if you run into issues in the migrated bot.</span></span>

## <a name="migration-troubleshootingknown-issues"></a><span data-ttu-id="eb177-169">Solución de problemas de migración y problemas conocidos</span><span class="sxs-lookup"><span data-stu-id="eb177-169">Migration troubleshooting/Known issues</span></span>
<span data-ttu-id="eb177-170">Mi bot de Node.js o de Functions se ha migrado correctamente, pero no responde:</span><span class="sxs-lookup"><span data-stu-id="eb177-170">My node.js/functions bot migrated successfully, but it fails to respond:</span></span>

* <span data-ttu-id="eb177-171">**Compruebe el punto de conexión**</span><span class="sxs-lookup"><span data-stu-id="eb177-171">**Check endpoint**</span></span>
  * <span data-ttu-id="eb177-172">Vaya a la hoja **Configuración** en el recurso del bot y compruebe que el punto de conexión del bot tiene un parámetro de cadena de consulta llamado "code" con un valor en él.</span><span class="sxs-lookup"><span data-stu-id="eb177-172">Go to the **Settings** blade in your bot resource and verify that the bot endpoint has a “code” querystring parameter with a value in it.</span></span> <span data-ttu-id="eb177-173">Si no es así, debe agregarlo.</span><span class="sxs-lookup"><span data-stu-id="eb177-173">If not, you need to add it.</span></span>
* <span data-ttu-id="eb177-174">**Compruebe si hay copias de seguridad en la carpeta de secretos de Kudu**</span><span class="sxs-lookup"><span data-stu-id="eb177-174">**Check secrets folder in kudu for backups**</span></span>
  * <span data-ttu-id="eb177-175">En algunos casos excepcionales, puede haber algunos archivos secretos de copia de seguridad que están creando un conflicto.</span><span class="sxs-lookup"><span data-stu-id="eb177-175">In some rare cases there might be a few backup secret files that are creating a conflict.</span></span> <span data-ttu-id="eb177-176">Vaya a la carpeta **home\data\Functions\secrets** en Kudu y elimine los archivos **host.snapshot** (o **host.backup**) que encuentre.</span><span class="sxs-lookup"><span data-stu-id="eb177-176">Go to the **home\data\Functions\secrets** folder in Kudu and delete any **host.snapshot** (or **host.backup**) file you find in there.</span></span> <span data-ttu-id="eb177-177">Debería haber solo un archivo **host.json** y un **messages.json**.</span><span class="sxs-lookup"><span data-stu-id="eb177-177">There should be only one **host.json** and one **messages.json**.</span></span> <span data-ttu-id="eb177-178">Finalmente, reinicie App Service y vuelva a intentar charlar con el bot.</span><span class="sxs-lookup"><span data-stu-id="eb177-178">Finally restart the App Service and retry chatting with your bot.</span></span>

<span data-ttu-id="eb177-179">Para cualquier otro problema, envíe un CRI al soporte técnico de Azure o envíe un problema en [GitHub](https://github.com/MicrosoftDocs/bot-framework-docs/issues).</span><span class="sxs-lookup"><span data-stu-id="eb177-179">For any other issue please submit a CRI to Azure Support or file an issue in [GitHub](https://github.com/MicrosoftDocs/bot-framework-docs/issues).</span></span>


## <a name="next-steps"></a><span data-ttu-id="eb177-180">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="eb177-180">Next steps</span></span>

<span data-ttu-id="eb177-181">Ahora que el bot se migrado, obtenga información sobre cómo administrar el bot desde Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="eb177-181">Now that your bot is migrated, learn how to manage your bot from the Azure portal.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="eb177-182">Administración de un bot</span><span class="sxs-lookup"><span data-stu-id="eb177-182">Manage a bot</span></span>](bot-service-manage-overview.md)
