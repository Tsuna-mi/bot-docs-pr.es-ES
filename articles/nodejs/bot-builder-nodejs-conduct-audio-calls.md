---
title: Realización de llamadas de audio | Microsoft Docs
description: Obtenga información sobre cómo realizar llamadas de audio con Skype en un bot mediante Node.js.
author: v-ducvo
ms.author: v-ducvo
manager: kamrani
ms.topic: article
ms.prod: bot-framework
ms.date: 12/13/17
monikerRange: azure-bot-service-3.0
ms.openlocfilehash: 35af3a339a20fe0e7e70d001db035aec2647aa35
ms.sourcegitcommit: 2dc75701b169d822c9499e393439161bc87639d2
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 08/24/2018
ms.locfileid: "42905324"
---
# <a name="support-audio-calls-with-skype"></a><span data-ttu-id="9f89a-103">Compatibilidad de las llamadas de audio con Skype</span><span class="sxs-lookup"><span data-stu-id="9f89a-103">Support audio calls with Skype</span></span>

[!INCLUDE [pre-release-label](../includes/pre-release-label-v3.md)]

<span data-ttu-id="9f89a-104">Skype admite una característica avanzada denominada Bots de llamadas.</span><span class="sxs-lookup"><span data-stu-id="9f89a-104">Skype supports a rich feature called Calling Bots.</span></span>  <span data-ttu-id="9f89a-105">Cuando se habilita, los usuarios pueden realizar una llamada de voz al bot e interactuar con él mediante la respuesta interactiva de voz (IVR).</span><span class="sxs-lookup"><span data-stu-id="9f89a-105">When enabled, users can place a voice call to your bot and interact with it using Interactive Voice Response (IVR).</span></span>  <span data-ttu-id="9f89a-106">El SDK de Bot Builder para Node.js incluye un [SDK de llamadas][calling_sdk] especial que los desarrolladores pueden usar para agregar características de llamadas al bot de chat.</span><span class="sxs-lookup"><span data-stu-id="9f89a-106">The Bot Builder for Node.js SDK includes a special [Calling SDK][calling_sdk] which developers can use to add calling features to their chat bot.</span></span>   

<span data-ttu-id="9f89a-107">El SDK de llamadas es muy similar al [SDK de chat][chat_sdk].</span><span class="sxs-lookup"><span data-stu-id="9f89a-107">The Calling SDK is very similar to the [Chat SDK][chat_sdk].</span></span> <span data-ttu-id="9f89a-108">Tienen clases similares, comparten construcciones comunes e incluso puede usar el SDK de chat para enviar un mensaje al usuario con el que está en una llamada.</span><span class="sxs-lookup"><span data-stu-id="9f89a-108">They have similar classes, share common constructs and you can even use the Chat SDK to send a message to the user you’re on a call with.</span></span>  <span data-ttu-id="9f89a-109">Los dos SDK están diseñados para ejecutarse en paralelo, pero, aunque son similares, existen algunas diferencias importantes y, por lo general, debe evitar mezclar las clases de las dos bibliotecas.</span><span class="sxs-lookup"><span data-stu-id="9f89a-109">The two SDKs are designed to run side-by-side but while they are similar, there are some significant differences and you should generally avoid mixing classes from the two libraries.</span></span>  

## <a name="create-a-calling-bot"></a><span data-ttu-id="9f89a-110">Creación de un bot de llamadas</span><span class="sxs-lookup"><span data-stu-id="9f89a-110">Create a calling bot</span></span>
<span data-ttu-id="9f89a-111">En el ejemplo de código siguiente se muestra cómo el programa "Hola mundo" de un chat de llamada tiene un aspecto muy similar a un bot de chat normal.</span><span class="sxs-lookup"><span data-stu-id="9f89a-111">The following example code shows how the "Hello World" for a calling bot looks very similar to a regular chat bot.</span></span> 

```javascript
var restify = require('restify');
var calling = require('botbuilder-calling');

// Setup Restify Server
var server = restify.createServer();
server.listen(process.env.port || process.env.PORT || 3978, function () {
   console.log(`${server.name} listening to ${server.url}`); 
});

// Create calling bot
var connector = new calling.CallConnector({
    callbackUrl: 'https://<your host>/api/calls',
    appId: '<your bots app id>',
    appPassword: '<your bots app password>'
});
var bot = new calling.UniversalCallBot(connector);
server.post('/api/calls', connector.listen());

// Add root dialog
bot.dialog('/', function (session) {
    session.send('Watson... come here!');
});
```

> [!NOTE]
> <span data-ttu-id="9f89a-112">Para buscar los valores **AppID** y **AppPassword** del bot, consulte [MicrosoftAppID and MicrosoftAppPassword](~/bot-service-manage-overview.md#microsoftappid-and-microsoftapppassword) (MicrosoftAppID y MicrosoftAppPassword).</span><span class="sxs-lookup"><span data-stu-id="9f89a-112">To find your bot's **AppID** and **AppPassword**, see [MicrosoftAppID and MicrosoftAppPassword](~/bot-service-manage-overview.md#microsoftappid-and-microsoftapppassword).</span></span>

<span data-ttu-id="9f89a-113">Actualmente, el emulador no admite los bots de llamadas de prueba.</span><span class="sxs-lookup"><span data-stu-id="9f89a-113">The emulator doesn’t currently support testing calling bots.</span></span> <span data-ttu-id="9f89a-114">Para probar el bot, debe realizar la mayoría de los pasos necesarios para publicar el bot.</span><span class="sxs-lookup"><span data-stu-id="9f89a-114">To test your bot, you’ll need to go through most of the steps required to publish your bot.</span></span>  <span data-ttu-id="9f89a-115">También deberá usar un cliente de Skype para interactuar con el bot.</span><span class="sxs-lookup"><span data-stu-id="9f89a-115">You will also need to use a Skype client to interact with the bot.</span></span> 

### <a name="enable-the-skype-channel"></a><span data-ttu-id="9f89a-116">Habilitación del canal de Skype</span><span class="sxs-lookup"><span data-stu-id="9f89a-116">Enable the Skype channel</span></span>
<span data-ttu-id="9f89a-117">[Registre el bot](../bot-service-quickstart-registration.md) y habilite el canal de Skype.</span><span class="sxs-lookup"><span data-stu-id="9f89a-117">[Register your bot](../bot-service-quickstart-registration.md) and enable the Skype channel.</span></span> <span data-ttu-id="9f89a-118">Deberá proporcionar un punto de conexión de mensajería al registrar el bot.</span><span class="sxs-lookup"><span data-stu-id="9f89a-118">You will need to provide a messaging endpoint when you register your bot.</span></span> <span data-ttu-id="9f89a-119">Se recomienda que empareje el bot de llamadas con un bot de chat para que el punto de conexión del bot de chat coincida con lo que colocaría normalmente en ese campo.</span><span class="sxs-lookup"><span data-stu-id="9f89a-119">It is recommended that you pair your calling bot with a chat bot so the chat bot’s endpoint is what you would normally put in that field.</span></span>  <span data-ttu-id="9f89a-120">Si solo va a registrar un bot de llamadas, simplemente puede pegar el punto de conexión de llamadas en ese campo.</span><span class="sxs-lookup"><span data-stu-id="9f89a-120">If you’re only registering a calling bot you can simply paste your calling endpoint into that field.</span></span>  

<span data-ttu-id="9f89a-121">Para habilitar la característica de llamadas real, deberá entrar en el canal de Skype del bot y activar la característica de llamadas.</span><span class="sxs-lookup"><span data-stu-id="9f89a-121">To enable the actual calling feature you’ll need to go into the Skype channel for your bot and turn on the calling feature.</span></span> <span data-ttu-id="9f89a-122">Se le proporcionará un campo en el que copiar el punto de conexión de llamadas.</span><span class="sxs-lookup"><span data-stu-id="9f89a-122">You’ll then be provided with a field to copy your calling endpoint into.</span></span> <span data-ttu-id="9f89a-123">Asegúrese de usar el vínculo de https ngrok para la parte del host del punto de conexión de llamadas.</span><span class="sxs-lookup"><span data-stu-id="9f89a-123">Make sure you use the https ngrok link for the host portion of your calling endpoint.</span></span>

<span data-ttu-id="9f89a-124">Durante el registro del bot, se le asignará un id. y una contraseña de aplicación, que debe pegar en la configuración del conector del bot Hola mundo.</span><span class="sxs-lookup"><span data-stu-id="9f89a-124">During the registration of your bot you’ll be assigned an app ID & password which you should paste into the connector settings for your hello world bot.</span></span> <span data-ttu-id="9f89a-125">También deberá tomar el vínculo completo de llamadas y pegarlo para la configuración de callbackUrl.</span><span class="sxs-lookup"><span data-stu-id="9f89a-125">You’ll also need to take your full calling link and paste that in for the callbackUrl setting.</span></span>

### <a name="add-bot-to-contacts"></a><span data-ttu-id="9f89a-126">Adición del bot a los contactos</span><span class="sxs-lookup"><span data-stu-id="9f89a-126">Add bot to contacts</span></span>
<span data-ttu-id="9f89a-127">En la página de registro del bot en el portal para desarrolladores, verá el botón **Add to Skype** (Agregar a Skype) situado junto al canal de Skype de bots.</span><span class="sxs-lookup"><span data-stu-id="9f89a-127">On your bot's registration page in the developer portal you’ll see an **add to Skype** button next to your bots Skype channel.</span></span> <span data-ttu-id="9f89a-128">Haga clic en el botón para agregar el bot a su lista de contactos de Skype.</span><span class="sxs-lookup"><span data-stu-id="9f89a-128">Click the button to add your bot to your contact list in Skype.</span></span>  <span data-ttu-id="9f89a-129">Una vez hecho, usted (y cualquier usuario al que le haya proporcionado el vínculo de unión) podrá comunicarse con el bot.</span><span class="sxs-lookup"><span data-stu-id="9f89a-129">Once you do that you (and anyone you give the join link to) will be able to communicate with the bot.</span></span>

### <a name="test-your-bot"></a><span data-ttu-id="9f89a-130">Prueba del bot</span><span class="sxs-lookup"><span data-stu-id="9f89a-130">Test your bot</span></span>
<span data-ttu-id="9f89a-131">Puede probar el bot con un cliente de Skype.</span><span class="sxs-lookup"><span data-stu-id="9f89a-131">You can test your bot using a Skype client.</span></span> <span data-ttu-id="9f89a-132">Debe ver que el icono de llamada está iluminado al hacer clic en la entrada de contacto de los bots (es posible que tenga que buscar el bot para verlo).  El icono de llamada puede tardar unos minutos en iluminarse si ha agregado llamadas a un bot existente.</span><span class="sxs-lookup"><span data-stu-id="9f89a-132">You should notice the call icon light up when you click on your bots contact entry (you may have to search for the bot to see it.)  It can take a few minutes for the call icon to light up if you’ve added calling to an existing bot.</span></span>  

<span data-ttu-id="9f89a-133">Si presiona el botón de llamada, debe marcar el bot y debe escucharlo hablar "Watson...</span><span class="sxs-lookup"><span data-stu-id="9f89a-133">If you press the call button it should dial your bot and you should hear it speak “Watson…</span></span> <span data-ttu-id="9f89a-134">come here!" ("Watson, ven aquí.")</span><span class="sxs-lookup"><span data-stu-id="9f89a-134">come here!”</span></span> <span data-ttu-id="9f89a-135">y, después, colgar.</span><span class="sxs-lookup"><span data-stu-id="9f89a-135">and then hang up.</span></span>

## <a name="calling-basics"></a><span data-ttu-id="9f89a-136">Conceptos básicos de las llamadas</span><span class="sxs-lookup"><span data-stu-id="9f89a-136">Calling basics</span></span>
<span data-ttu-id="9f89a-137">Las clases [UniversalCallBot](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.universalcallbot) y [CallConnector](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callconnector) le permiten crear un bot de llamadas en gran parte de la misma manera que lo haría con un bot de chat.</span><span class="sxs-lookup"><span data-stu-id="9f89a-137">The [UniversalCallBot](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.universalcallbot) and [CallConnector](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callconnector) classes let you author a calling bot in much the same way you would a chat bot.</span></span> <span data-ttu-id="9f89a-138">Agregue diálogos al bot prácticamente idénticos a los [diálogos de chat](bot-builder-nodejs-manage-conversation-flow.md).</span><span class="sxs-lookup"><span data-stu-id="9f89a-138">You add dialogs to your bot that are essentially identical to [chat dialogs](bot-builder-nodejs-manage-conversation-flow.md).</span></span> <span data-ttu-id="9f89a-139">Puede agregar [cascadas](bot-builder-nodejs-prompts.md) al bot.</span><span class="sxs-lookup"><span data-stu-id="9f89a-139">You can add [waterfalls](bot-builder-nodejs-prompts.md) to your bot.</span></span> <span data-ttu-id="9f89a-140">Hay un objeto de sesión, la clase [CallSession](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession), que contiene los métodos [answer()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#answer), [hangup()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#hangup) y [reject()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#reject) para administrar la llamada actual.</span><span class="sxs-lookup"><span data-stu-id="9f89a-140">There is a session object, the [CallSession](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession) class, which contains added [answer()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#answer), [hangup()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#hangup), and [reject()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#reject) methods for managing the current call.</span></span> <span data-ttu-id="9f89a-141">En general, no es necesario preocuparse por tales métodos de control de llamadas, aunque CallSession tiene una lógica para administrar automáticamente la llamada.</span><span class="sxs-lookup"><span data-stu-id="9f89a-141">In general, you don’t need to worry about these call control methods though as the CallSession has logic to automatically manage the call for you.</span></span> <span data-ttu-id="9f89a-142">Si realiza una acción, como el envío de un mensaje o una llamada a un símbolo del sistema integrado, la sesión responderá automáticamente a la llamada.</span><span class="sxs-lookup"><span data-stu-id="9f89a-142">The session will automatically answer the call if you take an action like sending a message or calling a built-in prompt.</span></span> <span data-ttu-id="9f89a-143">También colgará o rechazará automáticamente la llamada si llama a [endConversation()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#endconversation) o detecta que ha dejado de responder a las preguntas del autor de llamada (no llamó a un símbolo del sistema integrado).</span><span class="sxs-lookup"><span data-stu-id="9f89a-143">It will also automatically hangup/reject the call if you call [endConversation()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#endconversation) or it detects that you’ve stopped asking the caller questions (you didn’t call a built-in prompt.)</span></span>

<span data-ttu-id="9f89a-144">Otra diferencia entre los bots de chat y de llamadas es que, mientras los bots de chat suelen enviar mensajes, tarjetas y teclados a un usuario, un bot de llamadas se encarga de las acciones y los resultados.</span><span class="sxs-lookup"><span data-stu-id="9f89a-144">Another difference between calling and chat bots is that while chat bots typically send messages, cards, and keyboards to a user a calling bot deals in Actions and Outcomes.</span></span> <span data-ttu-id="9f89a-145">Los bots de llamadas de Skype son necesarios para crear [flujos de trabajo](http://docs.botframework.com/en-us/node/builder/calling-reference/interfaces/_botbuilder_d_.iworkflow) que constan de una o varias [acciones](http://docs.botframework.com/en-us/node/builder/calling-reference/interfaces/_botbuilder_d_.iaction).</span><span class="sxs-lookup"><span data-stu-id="9f89a-145">Skype calling bots are required to create [workflows](http://docs.botframework.com/en-us/node/builder/calling-reference/interfaces/_botbuilder_d_.iworkflow) that are comprised of one or more [actions](http://docs.botframework.com/en-us/node/builder/calling-reference/interfaces/_botbuilder_d_.iaction).</span></span>  <span data-ttu-id="9f89a-146">Se trata de otro aspecto sobre el que, en la práctica, no tiene que preocuparse demasiado, ya que el SDK de llamadas de Bot Builder administrará la mayoría.</span><span class="sxs-lookup"><span data-stu-id="9f89a-146">This is another thing that in practice you don’t have to worry too much about as the Bot Builder calling SDK will manage most of this for you.</span></span> <span data-ttu-id="9f89a-147">El método [CallSession.send()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#send) le permite pasar acciones o cadenas que se convertirán en [PlayPromptActions](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.playpromptaction).</span><span class="sxs-lookup"><span data-stu-id="9f89a-147">The [CallSession.send()](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.callsession#send) method lets you pass either actions or strings which it will turn into [PlayPromptActions](http://docs.botframework.com/en-us/node/builder/calling-reference/classes/_botbuilder_d_.playpromptaction).</span></span>  <span data-ttu-id="9f89a-148">La sesión contiene una lógica de procesamiento por lotes automática para combinar varias acciones en un único flujo de trabajo que se envía al servicio de llamadas a fin de que pueda llamar sin ningún riesgo a Send() varias veces.</span><span class="sxs-lookup"><span data-stu-id="9f89a-148">The session contains auto batching logic to combine multiple actions into a single workflow that’s submitted to the calling service so you can safely call send() multiple times.</span></span>  <span data-ttu-id="9f89a-149">Asimismo, debe confiar en las [solicitudes](bot-builder-nodejs-prompts.md) integradas del SDK para recopilar información del usuario a medida que se procesan todos los resultados.</span><span class="sxs-lookup"><span data-stu-id="9f89a-149">And you should rely on the SDK’s built-in [prompts](bot-builder-nodejs-prompts.md) to collect input from the user as they process all of the outcomes.</span></span>  

[calling_sdk]: http://docs.botframework.com/en-us/node/builder/calling-reference/modules/_botbuilder_d_
[chat_sdk]: http://docs.botframework.com/en-us/node/builder/chat-reference/modules/_botbuilder_d_
