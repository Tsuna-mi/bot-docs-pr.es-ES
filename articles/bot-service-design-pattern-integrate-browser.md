---
title: Integración del bot con un explorador web | Microsoft Docs
description: Obtenga información sobre cómo diseñar una transición adecuada de usuario del bot al explorador web y viceversa.
author: matvelloso
ms.author: mateusv
manager: kamrani
ms.topic: article
ms.prod: bot-framework
ms.date: 12/13/2017
ms.openlocfilehash: 7f3a6ace5e3ef8122cca32baf8ec4c9a1f250dfa
ms.sourcegitcommit: f576981342fb3361216675815714e24281e20ddf
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 07/18/2018
ms.locfileid: "39305080"
---
# <a name="integrate-your-bot-with-a-web-browser"></a><span data-ttu-id="fad80-103">Integración del bot con un explorador web</span><span class="sxs-lookup"><span data-stu-id="fad80-103">Integrate your bot with a web browser</span></span>

<span data-ttu-id="fad80-104">Algunos escenarios requieren algo más que solo un bot para satisfacer un requisito.</span><span class="sxs-lookup"><span data-stu-id="fad80-104">Some scenarios require more than just a bot to fulfill a requirement.</span></span> <span data-ttu-id="fad80-105">Puede que un bot deba enviar al usuario a un explorador web para completar una tarea y, a continuación, reanudar la conversación con el usuario una vez completada la tarea.</span><span class="sxs-lookup"><span data-stu-id="fad80-105">A bot may need to send the user to a web browser to complete a task and then resume the conversation with the user after the task has been completed.</span></span> 

## <a name="authentication-and-authorization"></a><span data-ttu-id="fad80-106">Autenticación y autorización</span><span class="sxs-lookup"><span data-stu-id="fad80-106">Authentication and authorization</span></span>
<span data-ttu-id="fad80-107">Si busca la capacidad de leer el calendario del usuario en Office 365, o quizás incluso crear citas en nombre del usuario, el usuario antes debe autenticarse en Microsoft Azure Active Directory y autorizar al bot a acceder a los datos del calendario del usuario.</span><span class="sxs-lookup"><span data-stu-id="fad80-107">If a bot wants the ability to read the user's calendar in Office 365, or perhaps even create appointments on behalf of that user, the user must first authenticate with Microsoft Azure Active Directory and authorize the bot to access the user's calendar data.</span></span> <span data-ttu-id="fad80-108">El bot redirigirá al usuario a un explorador web para completar las tareas de autenticación y autorización y, a continuación, reanudará la conversación con el usuario.</span><span class="sxs-lookup"><span data-stu-id="fad80-108">The bot will redirect the user to a web browser to complete the authentication and authorization tasks, and then will subsequently resume the conversation with the user.</span></span> 

## <a name="security-and-compliance"></a><span data-ttu-id="fad80-109">Seguridad y cumplimiento normativo</span><span class="sxs-lookup"><span data-stu-id="fad80-109">Security and compliance</span></span>
<span data-ttu-id="fad80-110">A menudo, los requisitos de seguridad y cumplimiento restringen el tipo de información que un bot puede intercambiar con un usuario.</span><span class="sxs-lookup"><span data-stu-id="fad80-110">Security and compliance requirements often restrict the type of information that a bot can exchange with a user.</span></span> <span data-ttu-id="fad80-111">En algunos casos, puede ser necesario que el usuario envíe y reciba datos fuera de la conversación actual.</span><span class="sxs-lookup"><span data-stu-id="fad80-111">In some cases, it may be necessary for the user to send/receive data outside of the current conversation.</span></span> <span data-ttu-id="fad80-112">Por ejemplo, si un usuario desea ejecutar un pago mediante un proveedor de pagos externo, no se debe especificar un número de tarjeta de crédito dentro del contexto de la conversación.</span><span class="sxs-lookup"><span data-stu-id="fad80-112">For example, if a user wants to execute a payment using a third-party payment provider, a credit card number should not be specified within the context of the conversation.</span></span> <span data-ttu-id="fad80-113">En su lugar, el bot redirigirá al usuario a un explorador web para completar el proceso de pago y, a continuación, reanudará la conversación con el usuario.</span><span class="sxs-lookup"><span data-stu-id="fad80-113">Instead, the bot will direct the user to a web browser to complete the payment process, and then will subsequently resume the conversation with the user.</span></span>

<span data-ttu-id="fad80-114">En este artículo se explora el proceso de facilitar la transición de un usuario desde el bot al explorador web y viceversa.</span><span class="sxs-lookup"><span data-stu-id="fad80-114">This article explores the process of facilitating a user's transition from bot to web browser, and back again.</span></span> 

> [!NOTE]
> <span data-ttu-id="fad80-115">La transición del chat al explorador web y a la inversa no es ideal, dado que el cambio entre aplicaciones puede confundir fácilmente a un usuario.</span><span class="sxs-lookup"><span data-stu-id="fad80-115">Transitioning from chat to web browser and back is not ideal, as switching between applications can easily confuse a user.</span></span> <span data-ttu-id="fad80-116">Para brindar una mejor experiencia, muchos canales ofrecen ventanas HTML integradas que un bot puede usar para presentar aplicaciones que, de lo contrario, aparecerían en un explorador web.</span><span class="sxs-lookup"><span data-stu-id="fad80-116">To provide a better experience, many channels offer built-in HTML windows that a bot can use to present applications would otherwise appear in a web browser.</span></span> <span data-ttu-id="fad80-117">Esta técnica permite al usuario permanecer dentro de la conversación a la vez que tiene acceso a recursos externos.</span><span class="sxs-lookup"><span data-stu-id="fad80-117">This technique allows the user to remain within the conversation while still accessing external resources.</span></span> <span data-ttu-id="fad80-118">Este enfoque es conceptualmente similar a las aplicaciones móviles que administran flujos de autorización mediante OAuth en las vistas web incrustadas.</span><span class="sxs-lookup"><span data-stu-id="fad80-118">This approach is conceptually similar to mobile applications managing authorization flows using OAuth within embedded web views.</span></span>

## <a name="bot-to-web-browser-and-back-again"></a><span data-ttu-id="fad80-119">Del bot al explorador web y viceversa</span><span class="sxs-lookup"><span data-stu-id="fad80-119">Bot to web browser, and back again</span></span>

<span data-ttu-id="fad80-120">En este diagrama se muestra el flujo de alto nivel para la integración entre el bot y un explorador web.</span><span class="sxs-lookup"><span data-stu-id="fad80-120">This diagram shows the high-level flow for integration between bot and web browser.</span></span> 

![Interacción entre bot y web](~/media/bot-service-design-pattern-integrate-browser/bot-to-web1.png)

<span data-ttu-id="fad80-122">Piense en cada paso del flujo:</span><span class="sxs-lookup"><span data-stu-id="fad80-122">Consider each step of the flow:</span></span>

1. <a id="generate-hyperlink"></a><span data-ttu-id="fad80-123">El bot genera y muestra un hipervínculo que redirigirá al usuario a un sitio web.</span><span class="sxs-lookup"><span data-stu-id="fad80-123">The bot generates and displays a hyperlink that will redirect the user to a website.</span></span> 
   <span data-ttu-id="fad80-124">El hipervínculo suele incluir datos a través de los parámetros de cadena de consulta en la dirección URL de destino que especifican información sobre el contexto de la conversación actual, por ejemplo, el id. de la conversación, el id. del canal y el id. del usuario en el canal.</span><span class="sxs-lookup"><span data-stu-id="fad80-124">The hyperlink typically includes data via querystring parameters on the target URL that specify information about the context of the current conversation, such as conversation ID, channel ID, and user ID in the channel.</span></span> 

2. <span data-ttu-id="fad80-125">El usuario hace clic en el hipervínculo y se le redirige a la dirección URL de destino dentro de un explorador web.</span><span class="sxs-lookup"><span data-stu-id="fad80-125">The user clicks the hyperlink and is redirected to the target URL within a web browser.</span></span> 

3. <span data-ttu-id="fad80-126">El bot entra en un estado en espera de comunicación desde el sitio web que indique que se ha completado el flujo del sitio web.</span><span class="sxs-lookup"><span data-stu-id="fad80-126">The bot enters a state awaiting communication from the website to indicate that the website flow is complete.</span></span>  
   > [!TIP]
   > <span data-ttu-id="fad80-127">Diseñe este flujo para que el bot no permanezca permanentemente en el estado "en espera" si el usuario nunca completa el flujo del sitio web.</span><span class="sxs-lookup"><span data-stu-id="fad80-127">Design this flow so that the bot will not permanently remain in the 'waiting' state if the user never completes the website flow.</span></span> <span data-ttu-id="fad80-128">En otras palabras, si el usuario abandona el explorador web y vuelve a comunicarse con el bot, el bot debe reconocer esa entrada, no [ignorarla](~/bot-service-design-navigation.md#the-mysterious-bot).</span><span class="sxs-lookup"><span data-stu-id="fad80-128">In other words, if the user abandons the web browser and starts communicating with the bot again, the bot should acknowledge, not [ignore](~/bot-service-design-navigation.md#the-mysterious-bot) that input.</span></span>

4. <span data-ttu-id="fad80-129">El usuario completa las tareas necesarias a través del explorador web.</span><span class="sxs-lookup"><span data-stu-id="fad80-129">The user completes the necessary task(s) via the web browser.</span></span> 
   <span data-ttu-id="fad80-130">Podría tratarse de un flujo de OAuth o cualquier secuencia de eventos necesaria para el escenario en cuestión.</span><span class="sxs-lookup"><span data-stu-id="fad80-130">This could be an OAuth flow or any sequence of events required by the scenario at hand.</span></span> 

5. <a id="generate-magic-number"></a><span data-ttu-id="fad80-131">Cuando el usuario completa el flujo del sitio web, este genera un "[número mágico](#verify-identity)" y se indica al usuario que copie el valor y lo pegue en la conversación con el bot.</span><span class="sxs-lookup"><span data-stu-id="fad80-131">When the user completes the website flow, the website generates a '[magic number](#verify-identity)' and instructs the user to copy the value and paste it back into the conversation with the bot.</span></span> 

6. <a id="signal-to-bot"></a><span data-ttu-id="fad80-132">El sitio web [ indica al bot](#website-signal-to-bot) que el usuario ha completado el flujo del sitio web.</span><span class="sxs-lookup"><span data-stu-id="fad80-132">The website [signals to the bot](#website-signal-to-bot) that the user has completed the website flow.</span></span> 
   <span data-ttu-id="fad80-133">Comunica el 'número mágico' al bot y proporciona todos los datos pertinentes.</span><span class="sxs-lookup"><span data-stu-id="fad80-133">It communicates the 'magic number' to the bot and provides any other relevant data.</span></span>
   <span data-ttu-id="fad80-134">Por ejemplo, en el caso de un flujo de OAuth, el sitio web podría proporcionar un token de acceso al bot.</span><span class="sxs-lookup"><span data-stu-id="fad80-134">For example, in the case of an OAuth flow, the website would provide an access token to the bot.</span></span>

7. <span data-ttu-id="fad80-135">El usuario vuelve al bot y pega el "número mágico" en el chat.</span><span class="sxs-lookup"><span data-stu-id="fad80-135">The user returns to the bot and pastes the 'magic number' into the chat.</span></span> 
   <span data-ttu-id="fad80-136">El bot valida que el "número mágico" proporcionado por el usuario coincida con el valor esperado, comprobando que el usuario actual es el mismo usuario que previamente hizo clic en el hipervínculo para iniciar el flujo del sitio web.</span><span class="sxs-lookup"><span data-stu-id="fad80-136">The bot validates that 'magic number' provided by the user matches the expected value, verifying that the current user is the same user who previously clicked the hyperlink to initiate the website flow.</span></span> 

### <a id="verify-identity"></a> <span data-ttu-id="fad80-137">Comprobación de la identidad del usuario mediante el "número mágico"</span><span class="sxs-lookup"><span data-stu-id="fad80-137">Verifying user identity using the 'magic number'</span></span>

<span data-ttu-id="fad80-138">La generación de un "número mágico" durante el flujo del bot al sitio web ([paso 5](#generate-magic-number) anterior) permite al bot comprobar posteriormente que el usuario que inició el flujo del sitio web sea realmente el usuario para el que estaba previsto.</span><span class="sxs-lookup"><span data-stu-id="fad80-138">The generation of a 'magic number' during the bot-to-website flow ([step 5](#generate-magic-number) above) enables the bot to subsequently verify that the user who initiated the website flow is indeed the user for whom it was intended.</span></span> <span data-ttu-id="fad80-139">Por ejemplo, si un bot está llevando a cabo un chat grupal con varios usuarios, cualquiera de ellos podría haber hecho clic en el hipervínculo para iniciar el flujo del sitio web.</span><span class="sxs-lookup"><span data-stu-id="fad80-139">For example, if a bot is conducting a group chat with multiple users, any one of them could have clicked the hyperlink to initiate the website flow.</span></span> <span data-ttu-id="fad80-140">Sin el proceso de validación del "número mágico", el bot no tiene manera de saber qué usuario ha completado el flujo.</span><span class="sxs-lookup"><span data-stu-id="fad80-140">Without the 'magic number' validation process, the bot has no way of knowing which user completed the flow.</span></span> <span data-ttu-id="fad80-141">Un usuario podría autenticarse e insertar los tokens de acceso en la sesión de otro usuario.</span><span class="sxs-lookup"><span data-stu-id="fad80-141">One user could authenticate and inject access tokens in another user's session.</span></span> 

> [!WARNING] 
> <span data-ttu-id="fad80-142">Este no es simplemente un riesgo de los chats grupales.</span><span class="sxs-lookup"><span data-stu-id="fad80-142">This isn't just a risk within group chats.</span></span> <span data-ttu-id="fad80-143">Sin el proceso de validación del "número mágico", cualquier persona que obtenga el hipervínculo para iniciar el flujo del sitio web puede suplantar la identidad de un usuario.</span><span class="sxs-lookup"><span data-stu-id="fad80-143">Without the 'magic number' validation process, anyone who obtains the hyperlink to launch the website flow can spoof a user's identity.</span></span> 

<span data-ttu-id="fad80-144">El número mágico debe ser un número aleatorio generado mediante una biblioteca de criptografía fuerte.</span><span class="sxs-lookup"><span data-stu-id="fad80-144">The magic number should be a random number generated using a strong cryptography library.</span></span> <span data-ttu-id="fad80-145">Para obtener un ejemplo del proceso de generación en C#, consulte <a href="https://github.com/MicrosoftDX/botauth/tree/master/CSharp" target="_blank">este código</a> dentro de la biblioteca <a href="https://www.nuget.org/packages/BotAuth" target="_blank">BotAuth</a>.</span><span class="sxs-lookup"><span data-stu-id="fad80-145">For an example of the generation process in C#, see <a href="https://github.com/MicrosoftDX/botauth/tree/master/CSharp" target="_blank">this code</a> within the <a href="https://www.nuget.org/packages/BotAuth" target="_blank">BotAuth</a> library.</span></span> <span data-ttu-id="fad80-146">BotAuth permite que los bots que están integrados en Microsoft Bot Framework implementen el flujo del bot al sitio web para autenticar a un usuario en un sitio web y, a continuación, usar el token de acceso que se generó a partir del proceso de autenticación.</span><span class="sxs-lookup"><span data-stu-id="fad80-146">BotAuth enables bots that are built in Microsoft Bot Framework to implement the bot-to-website flow to authenticate a user in a website and then to subsequently use the access token that was generated from the authentication process.</span></span> <span data-ttu-id="fad80-147">Puesto que BotAuth no realizar ninguna suposición acerca de las funcionalidades del canal, estos flujos deberían funcionar bien con la mayoría de los canales.</span><span class="sxs-lookup"><span data-stu-id="fad80-147">Since BotAuth does not make any assumptions about the channel's capabilities, such flows should function well with most channels.</span></span> 

> [!NOTE]
> <span data-ttu-id="fad80-148">La necesidad del proceso de validación del "número mágico" debería caer desuso a medida que canales creen sus propias vistas web incrustadas.</span><span class="sxs-lookup"><span data-stu-id="fad80-148">The need for the 'magic number' validation process should be deprecated as channels build their own embedded web views.</span></span>

### <a id="website-signal-to-bot"></a> <span data-ttu-id="fad80-149">¿Cómo hace el sitio web para "indicar" al bot?</span><span class="sxs-lookup"><span data-stu-id="fad80-149">How does the website 'signal' the bot?</span></span>

<span data-ttu-id="fad80-150">Cuando el bot [genera el hipervínculo](#generate-hyperlink) donde el usuario hará clic para iniciar el flujo del sitio web, incluye información a través de los parámetros de cadena de consulta en la dirección URL de destino sobre el contexto de la conversación actual, por ejemplo, el id. de la conversación, el id. del canal y el id. del usuario en el canal.</span><span class="sxs-lookup"><span data-stu-id="fad80-150">When the bot [generates the hyperlink](#generate-hyperlink) that the user will click to initiate the website flow, it includes information via querystring parameters in the target URL about the context of the current conversation, such as conversation ID, channel ID, and user ID in the channel.</span></span> <span data-ttu-id="fad80-151">Posteriormente, el sitio web puede usar esta información para leer y escribir variables de estado para ese usuario o esa conversación con el Bot Builder SDK o la API de REST.</span><span class="sxs-lookup"><span data-stu-id="fad80-151">The website can subsequently use this information to read and write state variables for that user or conversation using the Bot Builder SDK or REST APIs.</span></span> <span data-ttu-id="fad80-152">Consulte el [paso 6](#signal-to-bot) anterior para obtener un ejemplo de cómo el sitio web "indica" al bot que el flujo del sitio web está completo.</span><span class="sxs-lookup"><span data-stu-id="fad80-152">See [step 6](#signal-to-bot) above for an example of how the website 'signals' to the bot that the website flow is complete.</span></span>

## <a name="sample-code"></a><span data-ttu-id="fad80-153">Código de ejemplo</span><span class="sxs-lookup"><span data-stu-id="fad80-153">Sample code</span></span>

<span data-ttu-id="fad80-154">Como se describe en este artículo, la biblioteca <a href="https://github.com/MicrosoftDX/botauth" target="_blank">BotAuth</a> permite que los flujos de OAuth se enlacen con los bots que se compilan con .NET y Node en Microsoft Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="fad80-154">As described in this article, the <a href="https://github.com/MicrosoftDX/botauth" target="_blank">BotAuth</a> library enables OAuth flows to be bound to bots that are built using .NET and Node in the Microsoft Bot Framework.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="fad80-155">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="fad80-155">Additional resources</span></span>

- [<span data-ttu-id="fad80-156">Diálogos</span><span class="sxs-lookup"><span data-stu-id="fad80-156">Dialogs</span></span>](~/dotnet/bot-builder-dotnet-dialogs.md)
- [<span data-ttu-id="fad80-157">Administración del flujo de conversación con cuadros de diálogo (.NET)</span><span class="sxs-lookup"><span data-stu-id="fad80-157">Manage conversation flow with dialogs (.NET)</span></span>](~/dotnet/bot-builder-dotnet-manage-conversation-flow.md)
- [<span data-ttu-id="fad80-158">Administración del flujo de conversación con cuadros de diálogo (Node.js)</span><span class="sxs-lookup"><span data-stu-id="fad80-158">Manage conversation flow with dialogs (Node.js)</span></span>](~/nodejs/bot-builder-nodejs-manage-conversation-flow.md)
